<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication and Authorization - Weather API Documentation</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <h1>Authentication and Authorization</h1>
        <p class="subtitle">Learn how to authenticate your requests and manage API keys securely</p>
    </div>

    <div class="container">
        <div class="back-nav">
            <a href="../index.html">← Back to Documentation Home</a>
        </div>

        <p class="intro-text">All requests to the Weather API must be authenticated with an API key. Authentication ties usage to your account and enforces plan limits.</p>

        <h2>Prerequisites</h2>
        
        <ul class="simple-list">
            <li>An OpenWeather account with billing set up (if required by your plan).</li>
            <li>Access to your <strong>API Keys</strong> page in the dashboard.</li>
        </ul>

        <h2>Get your API key</h2>

        <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
                <h3>Sign in to the dashboard</h3>
                <p>Sign in to the OpenWeather dashboard.</p>
            </div>
        </div>

        <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
                <h3>Create a new key</h3>
                <p>Go to <strong>API Keys</strong> → <strong>Create Key</strong>.</p>
            </div>
        </div>

        <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
                <h3>Store securely</h3>
                <p>Copy the generated key and store it securely.</p>
            </div>
        </div>

        <div class="step">
            <div class="step-number">4</div>
            <div class="step-content">
                <h3>Add a label (Optional)</h3>
                <p>Add a label/description to track usage.</p>
            </div>
        </div>

        <div class="warning-box">
            <p>If a key is exposed or you suspect misuse, <strong>revoke it and create a new one</strong> immediately.</p>
        </div>

        <h2>Base URL</h2>

        <div class="code-block" data-language="plaintext">https://api.openweathermap.org/data/2.5</div>

        <h2>Ways to send your key</h2>

        <p>OpenWeather requires the key to be passed as the <code>appid</code> query parameter.</p>

        <h3>Standard usage</h3>

        <p>Append <code>appid=YOUR_API_KEY</code> to the request URL.</p>

        <div class="code-block" data-language="bash"># Replace YOUR_API_KEY first
API_KEY=YOUR_API_KEY

curl -s "https://api.openweathermap.org/data/2.5/weather?q=San%20Francisco,US&units=metric&appid=$API_KEY"</div>

        <div class="note-box">
            <p><strong>Note:</strong> Unlike some APIs, OpenWeather does <strong>not</strong> accept the key in an <code>Authorization</code> header. Always use the <code>appid</code> parameter.</p>
        </div>

        <h2>Make a test request (copy‑ready)</h2>

        <p>This verifies your key is valid and your network can reach the API.</p>

        <div class="code-block" data-language="bash">API_KEY=YOUR_API_KEY

curl -s "https://api.openweathermap.org/data/2.5/weather?q=San%20Francisco,US&units=metric&appid=$API_KEY"</div>

        <div class="response-example">
            <h4>Expected response (truncated)</h4>
            <div class="code-block" data-language="json">{
  "coord": { "lon": -122.4194, "lat": 37.7749 },
  "weather": [{ "id": 802, "main": "Clouds", "description": "scattered clouds" }],
  "main": {
    "temp": 18.2,
    "feels_like": 17.5,
    "humidity": 72
  },
  "name": "San Francisco"
}</div>
        </div>

        <h2>Apply API key restrictions</h2>

        <p>Reduce risk by limiting where and how your key can be used.</p>

        <ul class="simple-list">
            <li><strong>Application restrictions</strong> — Limit a key to certain origins or clients.
                <ul style="margin-top: 8px; padding-left: 20px;">
                    <li style="list-style-type: circle;">Web: restrict to allowed domains (e.g., <code>https://yourapp.example</code>)</li>
                    <li style="list-style-type: circle;">Server: restrict by source IPs or CIDR ranges</li>
                    <li style="list-style-type: circle;">Mobile: restrict to specific app identifiers / signing fingerprints</li>
                </ul>
            </li>
        </ul>

        <div class="warning-box">
            <p>Keys without restrictions are easier to abuse. Add restrictions before deploying to production.</p>
        </div>

        <h2>Key scope and limits</h2>

        <ul class="simple-list">
            <li><strong>Scope:</strong> Keys grant access to OpenWeather API endpoints for your account.</li>
            <li><strong>Rate limits:</strong> All requests made with your key count toward your plan (see <a href="rate-limits.html">Rate Limiting and Thresholds</a>).</li>
            <li><strong>Rotation:</strong> Rotate keys on a regular schedule and immediately after exposure.</li>
        </ul>

        <h2>Security best practices</h2>

        <ul class="simple-list">
            <li>Do not commit keys to Git, logs, or client-side code.</li>
            <li>Use environment variables or a secrets manager.</li>
            <li>Monitor usage and set alerts for unusual spikes.</li>
        </ul>

        <h2>Error responses</h2>

        <p>Authentication and authorization errors return standardized JSON. Use the HTTP status to branch handling logic.</p>

        <div class="error-example">
            <h4>401 Unauthorized — missing/invalid key</h4>
            <div class="code-block" data-language="http">HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
  "cod": 401,
  "message": "Invalid API key. Please see http://openweathermap.org/faq#error401 for more info."
}</div>
        </div>

        <div class="error-example">
            <h4>429 Too Many Requests — rate limit exceeded</h4>
            <div class="code-block" data-language="http">HTTP/1.1 429 Too Many Requests
Content-Type: application/json
Retry-After: 60

{
  "cod": 429,
  "message": "You have exceeded the allowed number of requests."
}</div>
        </div>

        <h2>What's next</h2>

        <ul class="simple-list">
            <li>Proceed to <a href="status-errors.html">Status and Error Codes</a> for the full response model.</li>
            <li>Review <a href="rate-limits.html">Rate Limiting and Thresholds</a> to plan retries and backoff.</li>
            <li>Continue with <a href="gettingstarted.html">Quick Start</a> and endpoint reference to build calls.</li>
        </ul>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add copy buttons to all code blocks
        const codeBlocks = document.querySelectorAll('.code-block');
        
        codeBlocks.forEach(block => {
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copy';
            button.onclick = function() {
                const text = block.textContent || block.innerText;
                navigator.clipboard.writeText(text).then(() => {
                    button.textContent = 'Copied!';
                    button.classList.add('copied');
                    setTimeout(() => {
                        button.textContent = 'Copy';
                        button.classList.remove('copied');
                    }, 2000);
                });
            };
            block.appendChild(button);
        });
    });
    </script>
</body>
</html>s